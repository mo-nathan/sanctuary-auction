<%= render "tabs", tab: "home" %>

<% if flash[:download_filename] %>
  <iframe src="<%= download_awards_path(flash[:download_filename]) %>" style="display:none;"></iframe>
<% end %>

<h1>Awards</h1>

<% if @award_files.empty? %>
  <p>No awards have been generated yet.</p>
  <%= button_to "Generate First Award", awards_path, method: :post, class: "btn btn-primary btn-lg" %>
<% else %>
  <%= button_to "Generate New Award", awards_path, method: :post, class: "btn btn-primary btn-lg mb-3" %>

  <h3>Previous Awards</h3>
  <ul class="list-group">
    <% @award_files.each do |filename| %>
      <% timestamp = filename.sub('awards_', '').sub('.csv', '') %>
      <% formatted_date = "#{timestamp[0..3]}-#{timestamp[4..5]}-#{timestamp[6..7]} #{timestamp[9..10]}:#{timestamp[11..12]}:#{timestamp[13..14]}" %>
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <%= formatted_date %>
        <div>
          <%= button_to "Delete", delete_awards_path(filename), method: :delete, class: "btn btn-sm btn-danger me-2", form: { class: "d-inline", data: { turbo_confirm: "Are you sure you want to delete this award file?" } } %>
          <%= link_to "Download", download_awards_path(filename), class: "btn btn-sm btn-info" %>
        </div>
      </li>
    <% end %>
  </ul>
<% end %>
